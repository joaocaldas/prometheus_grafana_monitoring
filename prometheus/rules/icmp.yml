groups:
  - name: icmp_alerts
    interval: 30s
    rules:
      - alert: ICMPHostDown
        expr: probe_success{job="icmp"} == 0
        for: 1m
        labels:
          severity: critical
          component: network
        annotations:
          summary: "Host ICMP indisponível"
          description: "O host {{ $labels.instance }} ({{ $labels.name }}) não está respondendo ao ping ICMP há mais de 1 minuto."
          value: "{{ $value }}"

      - alert: ICMPHighLatency
        expr: probe_icmp_duration_seconds{job="icmp"} > 0.5
        for: 2m
        labels:
          severity: warning
          component: network
        annotations:
          summary: "Latência ICMP alta"
          description: "O host {{ $labels.instance }} ({{ $labels.name }}) está com latência ICMP alta: {{ $value | humanize }}s (acima de 500ms)."
          value: "{{ $value }}"

      - alert: ICMPProbeFailed
        expr: probe_success{job="icmp"} == 0
        for: 30s
        labels:
          severity: warning
          component: network
        annotations:
          summary: "Falha na sonda ICMP"
          description: "A sonda ICMP falhou para o host {{ $labels.instance }} ({{ $labels.name }})."
          value: "{{ $value }}"

